{"version":3,"file":"templates.min.js","sources":["../src/templates.js"],"sourcesContent":["import Notification from \"core/notification\";\n\nlet openCourseEnabled = true;\n\nexport const courseCardTemplate = (values) => {\n    const elementDefinition = `\n    <div class=\"card mat-card ${values.userEnrolled ? 'to-course' : 'enrol-into-course'}\" data-id=\"${values.id}\" tabindex=\"0\">\n        <div class=\"card-content\"></div>\n    </div>`;\n    const element = $(elementDefinition);\n    const frontTemplate = courseCardFrontTemplate(values);\n    element.find('.card-content').append(frontTemplate);\n\n    // Handling course enrolment after clicking on primary card action button\n    const clickHandler = function() {\n        if (!openCourseEnabled) {\n            return;\n        }\n        let url;\n        if (values.userEnrolled) {\n            url = '/course/view.php?id=' + values.id;\n            window.location.href = window.location.href.replace(window.location.pathname, url);\n        } else {\n            url = '/blocks/course_explorer/ajax/enrol_user_into_course.php?courseid=' + values.id;\n            fetch(url, {\n                method: \"GET\",\n            })\n                .then((response) => response.json())\n                .then((result) => {\n                    if (result.enrolled) {\n                        url = '/course/view.php?id=' + values.id;\n                        window.location.href = window.location.href.replace(window.location.pathname, url);\n                    } else {\n                        Notification.alert('Error', result.errormessage, 'Close');\n                    }\n                    return console.log(result);\n                })\n                .catch((error) => console.log(error));\n        }\n    };\n    element.click(clickHandler);\n    element.keyup((event) => {\n        if (event.originalEvent instanceof KeyboardEvent\n            && event.key.toLocaleLowerCase() !== 'enter') {\n            return;\n        }\n        clickHandler();\n    });\n\n    return element;\n};\n\nconst truncateString = (str, length) => {\n    if (str.length <= length) {\n        return str; // Return the original string if it's already within or equal to 100 characters\n    } else {\n        return str.slice(0, length) + '...'; // Cut the string at 100 characters and add an ellipsis\n    }\n};\n\nconst getDesc = (description) => {\n    if (description.trim() !== '') {\n        return description;\n    } else {\n        return \"lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\";\n    }\n};\n\nconst courseCardFrontTemplate = (\n    {\n        title,\n        mcoriginal,\n        image,\n        description,\n        score,\n        reviewsnum,\n        senderName,\n        mc_moodle_format,\n        mc_moodle_kursdauer,\n        mc_moodle_themen\n    }\n) => {\n    title = truncateString(title, 100);\n    let courseCardDescription = getDesc(description);\n    courseCardDescription = truncateString(courseCardDescription, 150);\n\n    const courseType = mc_moodle_format;\n    const duration = mc_moodle_kursdauer;\n    const topics = mc_moodle_themen?.map(topic => topic.value);\n\n    return $(`\n    <div class=\"card-front\">\n        <div class=\"mat-card__image\">\n           ${image ?\n        \"<img src=\\\"\" + image + \"\\\" alt=\\\"\\\">\" : \"<img src=\\\"https://picsum.photos/2124\\\" alt=\\\"\\\">\"}\n        </div>\n        <div class=\"mat-card__background\"></div>\n        \n        ${mcoriginal ? \"<div class=\\\"mat-card__label mc-original\\\">MINT-Campus-Original</div>\" : \"\"}\n        \n        <div class=\"mat-card__content\">\n            <small class=\"mat-card__sender-name\">${senderName}</small>\n            <h3 class=\"mat-card__title\">\n                ${title}        \n            </h3>\n            <div class=\"mat-card__quick-facts d-sm-flex justify-content-between flex-wrap\">\n                <div class=\"d-flex align-items-center\">\n                    <i class=\"fa fa-graduation-cap mr-1\"></i>\n                    <span>${courseType}</span>\n                </div>\n                <div class=\"d-flex align-items-center\">\n                    <i class=\"fa fa-clock-o mr-1\"></i>\n                    <span>${duration}</span>\n                </div>\n                <div class=\"d-flex align-items-center\">\n                    ${getRating(score, reviewsnum)}\n                </div>\n            </div>\n            <p class=\"mat-card__description\">\n                ${courseCardDescription}\n            </p>\n            ${topics?.length > 0 ?\n                `<div class=\"mat-card__tags d-flex\">\n                    <div class=\"d-flex align-items-center\">\n                        <i class=\"fa fa-tag\"></i>\n                    </div>\n                    <div>${topics.join(', ')}</div>\n                </div>` :\n                \"\"\n            }\n        </div>\n    </div>`);\n};\n\nconst getRating = (score, reviewsnum) => {\n    reviewsnum = reviewsnum ?? 0;\n    let firstStarClass = 'fa-star-o';\n    let secondStarClass = 'fa-star-o';\n    let thirdStarClass = 'fa-star-o';\n    if (score) {\n        score = score * (3 / 5);\n        if (score < 0.75) {\n            firstStarClass = 'fa-star-half-o';\n        } else if (score < 1.25) {\n            firstStarClass = 'fa-star';\n        } else if (score < 1.75) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star-half-o';\n        } else if (score < 2.25) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n        } else if (score < 2.75) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n            thirdStarClass = 'fa-star-half-o';\n        } else {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n            thirdStarClass = 'fa-star';\n        }\n    }\n\n    return `<i class=\"fa ${firstStarClass}\"></i>\n            <i class=\"fa ${secondStarClass}\"></i>\n            <i class=\"fa ${thirdStarClass} mr-1\"></i>\n            <span>(${reviewsnum})</span>`;\n};\n\nexport const dropDownTemplate = (\n    {\n        title,\n        caption,\n        options,\n        onOptionChange,\n        selectedOption,\n        onReset,\n        className = \"\",\n    }\n) => {\n    let dropDown = $(`<div class=\"dropdown-container ${className}\"></div>`);\n    if (selectedOption) {\n        const resetDropdown = $(`<button class='btn reset-dropdown'><i class='fa fa-times'></i></button>`);\n        resetDropdown.click(onReset);\n        dropDown.append(resetDropdown);\n    }\n    dropDown.append(`\n    <button type=\"button\" class=\"btn btn-outline-secondary dropdown-toggle\" data-toggle=\"dropdown\" \n    style=\"width: 100%;\" aria-haspopup=\"true\" aria-expanded=\"false\" title=\"${title}\">\n        <div class=\"text-container\" data-active-item-text>\n            <div class=\"text\">${caption}</div>\n        </div>\n    </button>`);\n    const optionsMenu = $(`<div role=\"menu\" class=\"dropdown-menu dropdown-menu-right list-group hidden\" \n    data-show-active-item data-skip-active-class=\"true\"></div>`);\n    options.forEach((option) => {\n        const disabledAttribute = option?.disabled ? 'disabled' : '';\n        const isActive = selectedOption?.id === option.id;\n        const dropdownItem = $(`\n        <a class=\"dropdown-item ${disabledAttribute}\" data-value=\"${option.id}\" \n        aria-current=\"${isActive}\" tabindex=\"-1\" role=\"menuitem\">\n            ${option.name}\n        </a>`);\n        dropdownItem.click(() => onOptionChange(dropdownItem.data().value));\n        dropdownItem.keydown((event) => {\n            if (event.originalEvent instanceof KeyboardEvent && event.key.toLocaleLowerCase() === 'enter') {\n                return onOptionChange(dropdownItem.data().value);\n            }\n            return null;\n        });\n        optionsMenu.append(dropdownItem);\n    });\n    dropDown.append(optionsMenu);\n\n    return dropDown;\n};"],"names":["values","elementDefinition","userEnrolled","id","element","$","frontTemplate","courseCardFrontTemplate","find","append","clickHandler","url","window","location","href","replace","pathname","fetch","method","then","response","json","result","enrolled","alert","errormessage","console","log","catch","error","click","keyup","event","originalEvent","KeyboardEvent","key","toLocaleLowerCase","truncateString","str","length","slice","_ref","title","mcoriginal","image","description","score","reviewsnum","senderName","mc_moodle_format","mc_moodle_kursdauer","mc_moodle_themen","courseCardDescription","trim","getDesc","courseType","duration","topics","map","topic","value","getRating","join","firstStarClass","secondStarClass","thirdStarClass","_ref2","caption","options","onOptionChange","selectedOption","onReset","className","dropDown","resetDropdown","optionsMenu","forEach","option","disabledAttribute","disabled","isActive","dropdownItem","name","data","keydown"],"mappings":"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"}