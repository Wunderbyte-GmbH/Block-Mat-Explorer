{"version":3,"file":"templates.min.js","sources":["../../src/my-courses/templates.js"],"sourcesContent":["import Notification from \"core/notification\";\nimport $ from \"jquery\";\n\nexport const courseCardTemplate = (values) => {\n  const elementDefinition = `\n  <div class=\"card mat-card ${values.userEnrolled ? 'to-course' : 'enrol-into-course'}\" data-id=\"${values.id}\" tabindex=\"0\">\n      ${courseCardFrontTemplate(values)}\n  </div>`;\n  const element = $(elementDefinition);\n\n  // Handling course enrolment after clicking on primary card action button\n    const clickHandler = function() {\n        let url;\n        if (values.userEnrolled) {\n            url = '/course/view.php?id=' + values.id;\n            window.location.href = window.location.href.replace(window.location.pathname, url);\n        } else {\n            url = '/blocks/course_explorer/ajax/enrol_user_into_course.php?courseid=' + values.id;\n            fetch(url, {\n                method: \"GET\",\n            })\n                .then((response) => response.json())\n                .then((result) => {\n                    if (result.enrolled) {\n                        url = '/course/view.php?id=' + values.id;\n                        window.location.href = window.location.href.replace(window.location.pathname, url);\n                    } else {\n                        Notification.alert('Error', result.errormessage, 'Close');\n                    }\n                    return console.log(result);\n                })\n                .catch((error) => console.log(error));\n        }\n    };\n    element.click(clickHandler);\n    element.keyup((event) => {\n        if (event.originalEvent instanceof KeyboardEvent\n            && event.key.toLocaleLowerCase() !== 'enter') {\n            return;\n        }\n        clickHandler();\n    });\n\n  return element;\n};\n\nconst truncateString = (str, length) => {\n    if (str.length <= length) {\n        return str; // Return the original string if it's already within or equal to 100 characters\n    } else {\n        return str.slice(0, length) + '...'; // Cut the string at 100 characters and add an ellipsis\n    }\n};\n\nconst getDesc = (description) => {\n    if (description.trim() !== '') {\n        return description;\n    } else {\n        return \"lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\";\n    }\n};\n\nconst courseCardFrontTemplate = (\n    {\n        title,\n        MCOriginal,\n        image,\n        description,\n        score,\n        reviewsnum,\n        senderName,\n        courseType,\n        duration,\n        topics,\n        favourite,\n        ma_art1,\n        ma_art2,\n    }\n) => {\n    title = truncateString(title, 100);\n    let courseCardDescription = getDesc(description);\n    courseCardDescription = truncateString(courseCardDescription, 150);\n\n    topics = topics?.map(topic => topic.value);\n    const heartIconName = favourite ? \"heart-filled.png\" : \"heart-outline.png\";\n    const svgMatIcon = `\n    <div class=\"icon-container has-icon-color has-custom-mc-lila-color\" style=\"color:#551c77;width:20px;transform:rotate(0deg) scaleX(1) scaleY(1)\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 128 140\" fill=\"currentColor\">\n        <path d=\"M64,26.55c-27.62,0-50,22.38-50,50s22.38,50,50,50,50-22.38,50-50-22.38-50-50-50Zm18.65,63.1l-4.03,5.04\n            c-.26.33-.59.61-.96.81-.37.2-.78.33-1.2.38-.42.05-.85.01-1.25-.11-.41-.12-.79-.31-1.12-.58l-13.51-10.02\n            c-.94-.76-1.71-1.71-2.23-2.8-.52-1.09-.79-2.28-.79-3.49v-31.36c0-.86.34-1.68.94-2.28.6-.6,1.43-.94,2.28-.94h6.45\n            c.86,0,1.68.34,2.28.94.6.6.94,1.43.94,2.28v29.03l11.69,8.57c.33.26.61.59.81.96s.33.78.38,1.2c.05.42,0,.85-.11,1.25\n            -.12.41-.32.79-.58,1.12Z\" />\n        </svg>\n    </div>\n    `;\n\n    return `\n          <div class=\"position-relative card-header p-0\">\n            ${image ? `<img src=\"${image}\" class=\"card-img-top\" alt=\"\">` : `<img src=\"https://picsum.photos/2124\" class=\"card-img-top\" alt=\"\">`}\n            ${MCOriginal ? \"<div class=\\\"course-card__label mc-original\\\">MC-Original</div>\" : \"\"}\n            <div class=\"d-flex flex-wrap text-muted mb-2 small rating\">\n              <div class=\"d-flex align-items-center\">\n                ${getRating(score, reviewsnum)}\n              </div>\n            </div>\n        </div>\n          <div class=\"card-body\">\n            <div>\n                <span class=\"course-type\">${courseType}</span>\n                <h2 class=\"course-title\">${title}</h5>\n                <p class=\"card-text mb-1 sender\">${senderName}</p>\n            </div>\n            <div class=\"mr-3 d-flex align-items-center duration\">\n                                ${svgMatIcon}\n                <div>${ma_art1}${ma_art2 ? ', ' + ma_art2 : ''}</div>\n            </div>\n          </div>\n    `;\n};\n\nconst getRating = (score, reviewsnum) => {\n    reviewsnum = reviewsnum ?? 0;\n    let firstStarClass = 'fa-star-o';\n    let secondStarClass = 'fa-star-o';\n    let thirdStarClass = 'fa-star-o';\n    if (score) {\n        score = score * (3 / 5);\n        if (score < 0.75) {\n            firstStarClass = 'fa-star-half-o';\n        } else if (score < 1.25) {\n            firstStarClass = 'fa-star';\n        } else if (score < 1.75) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star-half-o';\n        } else if (score < 2.25) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n        } else if (score < 2.75) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n            thirdStarClass = 'fa-star-half-o';\n        } else {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n            thirdStarClass = 'fa-star';\n        }\n    }\n\n    return `<i class=\"fa ${firstStarClass}\"></i>\n            <i class=\"fa ${secondStarClass}\"></i>\n            <i class=\"fa ${thirdStarClass} mr-1\"></i>\n            <span>(${reviewsnum})</span>`;\n};"],"names":["values","elementDefinition","userEnrolled","id","courseCardFrontTemplate","element","clickHandler","url","window","location","href","replace","pathname","fetch","method","then","response","json","result","enrolled","alert","errormessage","console","log","catch","error","click","keyup","event","originalEvent","KeyboardEvent","key","toLocaleLowerCase","truncateString","str","length","slice","_ref","title","MCOriginal","image","description","score","reviewsnum","senderName","courseType","duration","topics","favourite","ma_art1","ma_art2","courseCardDescription","trim","getDesc","_topics","map","topic","value","getRating","firstStarClass","secondStarClass","thirdStarClass"],"mappings":"yaAGmCA,eAC3BC,kBAAqB,iCACCD,OAAOE,aAAe,YAAc,iCAAiCF,OAAOG,4BAClGC,wBAAwBJ,oBAExBK,SAAU,mBAAEJ,mBAGVK,aAAe,eACbC,IACAP,OAAOE,cACPK,IAAM,uBAAyBP,OAAOG,GACtCK,OAAOC,SAASC,KAAOF,OAAOC,SAASC,KAAKC,QAAQH,OAAOC,SAASG,SAAUL,OAE9EA,IAAM,oEAAsEP,OAAOG,GACnFU,MAAMN,IAAK,CACPO,OAAQ,QAEPC,MAAMC,UAAaA,SAASC,SAC5BF,MAAMG,SACCA,OAAOC,UACPZ,IAAM,uBAAyBP,OAAOG,GACtCK,OAAOC,SAASC,KAAOF,OAAOC,SAASC,KAAKC,QAAQH,OAAOC,SAASG,SAAUL,4BAEjEa,MAAM,QAASF,OAAOG,aAAc,SAE9CC,QAAQC,IAAIL,WAEtBM,OAAOC,OAAUH,QAAQC,IAAIE,kBAG1CpB,QAAQqB,MAAMpB,cACdD,QAAQsB,OAAOC,QACPA,MAAMC,yBAAyBC,eACM,UAAlCF,MAAMG,IAAIC,qBAGjB1B,kBAGCD,eAGH4B,eAAiB,CAACC,IAAKC,SACrBD,IAAIC,QAAUA,OACPD,IAEAA,IAAIE,MAAM,EAAGD,QAAU,MAehC/B,wBAA0BiC,uBAC5BC,MACIA,MADJC,WAEIA,WAFJC,MAGIA,MAHJC,YAIIA,YAJJC,MAKIA,MALJC,WAMIA,WANJC,WAOIA,WAPJC,WAQIA,WARJC,SASIA,SATJC,OAUIA,OAVJC,UAWIA,UAXJC,QAYIA,QAZJC,QAaIA,cAGJZ,MAAQL,eAAeK,MAAO,SAC1Ba,sBA7BSV,CAAAA,aACc,KAAvBA,YAAYW,OACLX,YAEA,sOAyBiBY,CAAQZ,aACpCU,sBAAwBlB,eAAekB,sBAAuB,KAE9DJ,uBAASA,iCAAAO,QAAQC,KAAIC,OAASA,MAAMC,cAc5B,4EAEEjB,MAAS,aAAYA,sCAAyC,qFAC9DD,WAAa,gEAAoE,uJAG7EmB,UAAUhB,MAAOC,0KAMSE,+DACDP,gEACQM,i+BAI5BK,UAAUC,QAAU,KAAOA,QAAU,wDAMtDQ,UAAY,CAAChB,MAAOC,kBAElBgB,eAAiB,YACjBC,gBAAkB,YAClBC,eAAiB,mBACjBnB,SACAA,WACY,IACRiB,eAAiB,iBACVjB,MAAQ,KACfiB,eAAiB,UACVjB,MAAQ,MACfiB,eAAiB,UACjBC,gBAAkB,kBACXlB,MAAQ,MACfiB,eAAiB,UACjBC,gBAAkB,WACXlB,MAAQ,MACfiB,eAAiB,UACjBC,gBAAkB,UAClBC,eAAiB,mBAEjBF,eAAiB,UACjBC,gBAAkB,UAClBC,eAAiB,YAIjB,gBAAeF,kDACAC,mDACAC,iDA7BvBlB,WAAaA,YAAc"}