{"version":3,"file":"templates.min.js","sources":["../../src/my-courses/templates.js"],"sourcesContent":["import Notification from \"core/notification\";\n\nexport const courseCardTemplate = (values) => {\n  const elementDefinition = `\n  <div class=\"card course-card ${values.userEnrolled ? 'to-course' : 'enrol-into-course'}\" data-id=\"${values.id}\" tabindex=\"0\">\n    <div class=\"card-content\">\n    <div class=\"card-front\">\n      ${courseCardFrontTemplate(values)}\n    </div>\n    </div>\n  </div>`;\n  const element = $(elementDefinition);\n\n  // Handling course enrolment after clicking on primary card action button\n    const clickHandler = function() {\n        let url;\n        if (values.userEnrolled) {\n            url = '/course/view.php?id=' + values.id;\n            window.location.href = window.location.href.replace(window.location.pathname, url);\n        } else {\n            url = '/blocks/course_explorer/ajax/enrol_user_into_course.php?courseid=' + values.id;\n            fetch(url, {\n                method: \"GET\",\n            })\n                .then((response) => response.json())\n                .then((result) => {\n                    if (result.enrolled) {\n                        url = '/course/view.php?id=' + values.id;\n                        window.location.href = window.location.href.replace(window.location.pathname, url);\n                    } else {\n                        Notification.alert('Error', result.errormessage, 'Close');\n                    }\n                    return console.log(result);\n                })\n                .catch((error) => console.log(error));\n        }\n    };\n    element.click(clickHandler);\n    element.keyup((event) => {\n        if (event.originalEvent instanceof KeyboardEvent\n            && event.key.toLocaleLowerCase() !== 'enter') {\n            return;\n        }\n        clickHandler();\n    });\n\n  return element;\n};\n\nconst truncateString = (str, length) => {\n    if (str.length <= length) {\n        return str; // Return the original string if it's already within or equal to 100 characters\n    } else {\n        return str.slice(0, length) + '...'; // Cut the string at 100 characters and add an ellipsis\n    }\n};\n\nconst getDesc = (description) => {\n    if (description.trim() !== '') {\n        return description;\n    } else {\n        return \"lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\" +\n            \" lorem ipsum dolor sit amet, consectetur adipiscing elit.\";\n    }\n};\n\nconst courseCardFrontTemplate = (\n    {\n        title,\n        MCOriginal,\n        image,\n        description,\n        score,\n        reviewsnum,\n        senderName,\n        courseType,\n        duration,\n        topics,\n        favourite\n    }\n) => {\n    title = truncateString(title, 100);\n    let courseCardDescription = getDesc(description);\n    courseCardDescription = truncateString(courseCardDescription, 150);\n\n    topics = topics?.map(topic => topic.value);\n    const heartIconName = favourite ? \"heart-filled.png\" : \"heart-outline.png\";\n\n    return `\n    <div class=\"course-card__image\">\n       ${image ?\n          \"<img src=\\\"\" + image + \"\\\" alt=\\\"\\\">\" : \"<img src=\\\"https://picsum.photos/2124\\\" alt=\\\"\\\">\"}\n    </div>\n    <div class=\"course-card__background\"></div>\n    \n    ${MCOriginal ? \"<div class=\\\"course-card__label mc-original\\\">MINT-Campus-Original</div>\" : \"\"}\n    <div class=\"course-card__label favourite\">\n        <img src=\"/blocks/course_explorer/resources/images/${heartIconName}\" alt=\"${heartIconName}\">\n    </div>\n   \n    \n    <div class=\"course-card__content\">\n        <small class=\"course-card__sender-name\">${senderName ?? ''}</small>\n        <h3 class=\"course-card__title\">\n            ${title}        \n        </h3>\n        <div class=\"course-card__quick-facts d-sm-flex justify-content-between flex-wrap\">\n            <div class=\"d-flex align-items-center\">\n                <i class=\"fa fa-graduation-cap mr-1\"></i>\n                <span>${courseType ?? ''}</span>\n            </div>\n            <div class=\"d-flex align-items-center\">\n                <i class=\"fa fa-clock-o mr-1\"></i>\n                <span>${duration ?? ''}</span>\n            </div>\n            <div class=\"d-flex align-items-center\">\n                ${getRating(score, reviewsnum)}\n            </div>\n        </div>\n        <p class=\"course-card__description\">\n            ${courseCardDescription}\n        </p>\n        ${topics?.length > 0 ?\n        `<div class=\"course-card__tags d-flex\">\n                <div class=\"d-flex align-items-center\">\n                    <i class=\"fa fa-tag\"></i>\n                </div>\n                <div>${topics.join(', ')}</div>\n            </div>` :\n        \"\"}\n    </div>`;\n};\n\nconst getRating = (score, reviewsnum) => {\n    reviewsnum = reviewsnum ?? 0;\n    let firstStarClass = 'fa-star-o';\n    let secondStarClass = 'fa-star-o';\n    let thirdStarClass = 'fa-star-o';\n    if (score) {\n        score = score * (3 / 5);\n        if (score < 0.75) {\n            firstStarClass = 'fa-star-half-o';\n        } else if (score < 1.25) {\n            firstStarClass = 'fa-star';\n        } else if (score < 1.75) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star-half-o';\n        } else if (score < 2.25) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n        } else if (score < 2.75) {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n            thirdStarClass = 'fa-star-half-o';\n        } else {\n            firstStarClass = 'fa-star';\n            secondStarClass = 'fa-star';\n            thirdStarClass = 'fa-star';\n        }\n    }\n\n    return `<i class=\"fa ${firstStarClass}\"></i>\n            <i class=\"fa ${secondStarClass}\"></i>\n            <i class=\"fa ${thirdStarClass} mr-1\"></i>\n            <span>(${reviewsnum})</span>`;\n};"],"names":["values","elementDefinition","userEnrolled","id","courseCardFrontTemplate","element","$","clickHandler","url","window","location","href","replace","pathname","fetch","method","then","response","json","result","enrolled","alert","errormessage","console","log","catch","error","click","keyup","event","originalEvent","KeyboardEvent","key","toLocaleLowerCase","truncateString","str","length","slice","_ref","title","MCOriginal","image","description","score","reviewsnum","senderName","courseType","duration","topics","favourite","courseCardDescription","trim","getDesc","_topics","map","topic","value","heartIconName","getRating","join","firstStarClass","secondStarClass","thirdStarClass"],"mappings":"sTAEmCA,eAC3BC,kBAAqB,oCACID,OAAOE,aAAe,YAAc,iCAAiCF,OAAOG,0FAGrGC,wBAAwBJ,4CAIxBK,QAAUC,EAAEL,mBAGVM,aAAe,eACbC,IACAR,OAAOE,cACPM,IAAM,uBAAyBR,OAAOG,GACtCM,OAAOC,SAASC,KAAOF,OAAOC,SAASC,KAAKC,QAAQH,OAAOC,SAASG,SAAUL,OAE9EA,IAAM,oEAAsER,OAAOG,GACnFW,MAAMN,IAAK,CACPO,OAAQ,QAEPC,MAAMC,UAAaA,SAASC,SAC5BF,MAAMG,SACCA,OAAOC,UACPZ,IAAM,uBAAyBR,OAAOG,GACtCM,OAAOC,SAASC,KAAOF,OAAOC,SAASC,KAAKC,QAAQH,OAAOC,SAASG,SAAUL,4BAEjEa,MAAM,QAASF,OAAOG,aAAc,SAE9CC,QAAQC,IAAIL,WAEtBM,OAAOC,OAAUH,QAAQC,IAAIE,kBAG1CrB,QAAQsB,MAAMpB,cACdF,QAAQuB,OAAOC,QACPA,MAAMC,yBAAyBC,eACM,UAAlCF,MAAMG,IAAIC,qBAGjB1B,kBAGCF,eAGH6B,eAAiB,CAACC,IAAKC,SACrBD,IAAIC,QAAUA,OACPD,IAEAA,IAAIE,MAAM,EAAGD,QAAU,MAehChC,wBAA0BkC,gCAC5BC,MACIA,MADJC,WAEIA,WAFJC,MAGIA,MAHJC,YAIIA,YAJJC,MAKIA,MALJC,WAMIA,WANJC,WAOIA,WAPJC,WAQIA,WARJC,SASIA,SATJC,OAUIA,OAVJC,UAWIA,gBAGJV,MAAQL,eAAeK,MAAO,SAC1BW,sBA3BSR,CAAAA,aACc,KAAvBA,YAAYS,OACLT,YAEA,sOAuBiBU,CAAQV,aACpCQ,sBAAwBhB,eAAegB,sBAAuB,KAE9DF,uBAASA,iCAAAK,QAAQC,KAAIC,OAASA,MAAMC,cAC9BC,cAAgBR,UAAY,mBAAqB,0BAE/C,kDAEHR,MACC,aAAgBA,MAAQ,YAAiB,2HAI7CD,WAAa,yEAA6E,kHAEnCiB,uBAAuBA,mIAKlCZ,YAAc,oEAElDN,mQAKUO,YAAc,iKAIdC,UAAY,uGAGlBW,UAAUf,MAAOC,8GAIrBM,kEAEJF,2CAAQZ,QAAS,EAClB,gMAIcY,OAAOW,KAAK,kCAE3B,kBAIFD,UAAY,CAACf,MAAOC,kBAElBgB,eAAiB,YACjBC,gBAAkB,YAClBC,eAAiB,mBACjBnB,SACAA,WACY,IACRiB,eAAiB,iBACVjB,MAAQ,KACfiB,eAAiB,UACVjB,MAAQ,MACfiB,eAAiB,UACjBC,gBAAkB,kBACXlB,MAAQ,MACfiB,eAAiB,UACjBC,gBAAkB,WACXlB,MAAQ,MACfiB,eAAiB,UACjBC,gBAAkB,UAClBC,eAAiB,mBAEjBF,eAAiB,UACjBC,gBAAkB,UAClBC,eAAiB,YAIjB,gBAAeF,kDACAC,mDACAC,iDA7BvBlB,WAAaA,YAAc"}