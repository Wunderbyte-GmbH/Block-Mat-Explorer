{"version":3,"file":"main.min.js","sources":["../../src/my-courses/main.js"],"sourcesContent":["/**\n * Bla-bla\n */\n\nimport {setWsToken} from \"../token\";\nimport {getMyCourses} from \"../api\";\nimport {courseCardTemplate} from \"./templates\";\nimport * as loading from \"../loading\";\nimport { getElement, setInstanceId } from \"../static-selectors\";\nimport {\n  FILTER_TYPES,\n  updateFilterState,\n  updateMainContainer,\n  initiateSearch,\n  updateCourseCount,\n  getFilterState,\n  prepareSortDropdown,\n  SORT_TYPES,\n} from \"../static-selectors\";\nimport {createPagination} from \"../pagination\";\n\nlet courses = [];\n\nconst handleFilter = () => {\n  let filteredCourses = courses.filter(course => course.ismaterial === true);\n  const filterStates = getFilterState();\n\n  if (filterStates[FILTER_TYPES.QUERY] !== null) {\n    const toSearch = filterStates[FILTER_TYPES.QUERY].toLowerCase();\n    filteredCourses = filteredCourses.filter((course) => {\n      return (\n        course.title.toLowerCase().includes(toSearch) ||\n        course.description.toLowerCase().includes(toSearch)\n      );\n    });\n  }\n\n  if (filterStates.ORDER) {\n    const {direction, field} = SORT_TYPES[filterStates.ORDER];\n    filteredCourses.sort((a, b) => {\n      if (a[field] > b[field]) {\n        return direction;\n      } else if (a[field] < b[field]) {\n        return -direction;\n      } else {\n        return 0;\n      }\n    });\n  }\n  const returnValues = [...filteredCourses];\n\n  updateCourseCount(filteredCourses.length);\n  initiatePagination({\n    currentPage: filterStates.CURRENT_PAGE + 1,\n    total: filteredCourses.length,\n    perPage: filterStates.PAGE_SIZE,\n  });\n  updateMainContainer(\n    filteredCourses\n      .slice(filterStates.CURRENT_PAGE * filterStates.PAGE_SIZE, (filterStates.CURRENT_PAGE + 1) * filterStates.PAGE_SIZE)\n      .map((course) => courseCardTemplate(course))\n  );\n\n  return returnValues;\n};\n\nconst initiatePagination = ({currentPage, total, perPage}) => {\n  createPagination({\n    container: getElement(\"matTopPaginationContainer\"),\n    currentPage,\n    total,\n    perPage,\n    onChange: (page) => {\n      if (updateFilterState(FILTER_TYPES.CURRENT_PAGE, page - 1)) {\n        handleFilter();\n      }\n    },\n  });\n\n  createPagination({\n    container: getElement(\"matBottomPaginationContainer\"),\n    currentPage,\n    total,\n    perPage,\n    onChange: (page) => {\n      if (updateFilterState(FILTER_TYPES.CURRENT_PAGE, page - 1)) {\n        handleFilter();\n      }\n    },\n  });\n};\n\nexport const init = ({wsToken, userid, instanceId}) => {\n  setInstanceId(instanceId);\n  setWsToken(wsToken);\n  loading.show();\n  getMyCourses(\n    userid,\n    (response) => {\n      if (response) {\n        courses = response;\n        initiateSearch(handleFilter);\n        prepareSortDropdown(handleFilter);\n        handleFilter();\n\n        setTimeout(() => {\n          loading.hide();\n        }, 1000);\n      }\n    });\n};\n"],"names":["courses","handleFilter","filteredCourses","filter","course","ismaterial","filterStates","FILTER_TYPES","QUERY","toSearch","toLowerCase","title","includes","description","ORDER","direction","field","SORT_TYPES","sort","a","b","returnValues","length","initiatePagination","currentPage","CURRENT_PAGE","total","perPage","PAGE_SIZE","slice","map","_ref","container","onChange","page","_ref2","wsToken","userid","instanceId","loading","show","response","setTimeout","hide"],"mappings":"+tCAqBIA,QAAU,SAERC,aAAe,SACfC,gBAAkBF,QAAQG,QAAOC,SAAgC,IAAtBA,OAAOC,mBAChDC,cAAe,wCAEoB,OAArCA,aAAaC,8BAAaC,OAAiB,OACvCC,SAAWH,aAAaC,8BAAaC,OAAOE,cAClDR,gBAAkBA,gBAAgBC,QAAQC,QAEtCA,OAAOO,MAAMD,cAAcE,SAASH,WACpCL,OAAOS,YAAYH,cAAcE,SAASH,eAK5CH,aAAaQ,MAAO,OAChBC,UAACA,UAADC,MAAYA,OAASC,4BAAWX,aAAaQ,OACnDZ,gBAAgBgB,MAAK,CAACC,EAAGC,IACnBD,EAAEH,OAASI,EAAEJ,OACRD,UACEI,EAAEH,OAASI,EAAEJ,QACdD,UAED,UAIPM,aAAe,IAAInB,8DAEPA,gBAAgBoB,QAClCC,mBAAmB,CACjBC,YAAalB,aAAamB,aAAe,EACzCC,MAAOxB,gBAAgBoB,OACvBK,QAASrB,aAAasB,qDAGtB1B,gBACG2B,MAAMvB,aAAamB,aAAenB,aAAasB,WAAYtB,aAAamB,aAAe,GAAKnB,aAAasB,WACzGE,KAAK1B,SAAW,iCAAmBA,WAGjCiB,cAGHE,mBAAqBQ,WAACP,YAACA,YAADE,MAAcA,MAAdC,QAAqBA,+CAC9B,CACfK,WAAW,+BAAW,6BACtBR,YAAAA,YACAE,MAAAA,MACAC,QAAAA,QACAM,SAAWC,QACL,sCAAkB3B,8BAAakB,aAAcS,KAAO,IACtDjC,mDAKW,CACf+B,WAAW,+BAAW,gCACtBR,YAAAA,YACAE,MAAAA,MACAC,QAAAA,QACAM,SAAWC,QACL,sCAAkB3B,8BAAakB,aAAcS,KAAO,IACtDjC,iCAMYkC,YAACC,QAACA,QAADC,OAAUA,OAAVC,WAAkBA,qDACvBA,kCACHF,SACXG,QAAQC,6BAENH,QACCI,WACKA,WACFzC,QAAUyC,6CACKxC,uDACKA,cACpBA,eAEAyC,YAAW,KACTH,QAAQI,SACP"}