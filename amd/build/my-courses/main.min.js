define("block_mat_explorer/my-courses/main",["exports","../token","../api","./templates","../loading","../static-selectors","../pagination"],(function(_exports,_token,_api,_templates,loading,_staticSelectors,_pagination){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,loading=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(loading);let courses=[];const handleFilter=()=>{let filteredCourses=[...courses];const filterStates=(0,_staticSelectors.getFilterState)();if(null!==filterStates[_staticSelectors.FILTER_TYPES.QUERY]){const toSearch=filterStates[_staticSelectors.FILTER_TYPES.QUERY].toLowerCase();filteredCourses=filteredCourses.filter((course=>course.title.toLowerCase().includes(toSearch)||course.description.toLowerCase().includes(toSearch)))}if(filterStates.ORDER){const{direction:direction,field:field}=_staticSelectors.SORT_TYPES[filterStates.ORDER];filteredCourses.sort(((a,b)=>a[field]>b[field]?direction:a[field]<b[field]?-direction:0))}const returnValues=[...filteredCourses];return(0,_staticSelectors.updateCourseCount)(filteredCourses.length),initiatePagination({currentPage:filterStates.CURRENT_PAGE+1,total:filteredCourses.length,perPage:filterStates.PAGE_SIZE}),(0,_staticSelectors.updateMainContainer)(filteredCourses.splice(filterStates.CURRENT_PAGE*filterStates.PAGE_SIZE,filterStates.PAGE_SIZE).map((course=>(0,_templates.courseCardTemplate)(course)))),returnValues},initiatePagination=_ref=>{let{currentPage:currentPage,total:total,perPage:perPage}=_ref;(0,_pagination.createPagination)({container:(0,_staticSelectors.getElement)("matTopPaginationContainer"),currentPage:currentPage,total:total,perPage:perPage,onChange:page=>{(0,_staticSelectors.updateFilterState)(_staticSelectors.FILTER_TYPES.CURRENT_PAGE,page-1)&&handleFilter()}}),(0,_pagination.createPagination)({container:(0,_staticSelectors.getElement)("matBottomPaginationContainer"),currentPage:currentPage,total:total,perPage:perPage,onChange:page=>{(0,_staticSelectors.updateFilterState)(_staticSelectors.FILTER_TYPES.CURRENT_PAGE,page-1)&&handleFilter()}})};_exports.init=_ref2=>{let{wsToken:wsToken,userid:userid,instanceId:instanceId}=_ref2;(0,_staticSelectors.setInstanceId)(instanceId),(0,_token.setWsToken)(wsToken),loading.show(),(0,_api.getMyCourses)(userid,(response=>{response&&(courses=response,(0,_staticSelectors.initiateSearch)(handleFilter),(0,_staticSelectors.prepareSortDropdown)(handleFilter),handleFilter(),setTimeout((()=>{loading.hide()}),1e3))}))}}));

//# sourceMappingURL=main.min.js.map